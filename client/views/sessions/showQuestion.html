<div class="row">
  <div class="col-xs-10 col-xs-offset-1">
    <div class="jumbotron pg-content-container">
      <!-- Title -->
      <h1 class="pg-content-title">{{vm.session._test.title}}</h1>
      <div class="well" id="session-question-page-container">
        
        <div class="row">
          <div class="col-xs-6">
            <p>#{{vm.trackingData.qNum}} of {{vm.testLength}}</p>
            <div class="progress progress-striped active">
              <div class="progress-bar" style="width: {{(vm.trackingData.qNum/vm.testLength)*100}}%"></div>
            </div>
            <p>uPerformance: {{vm.trackingData.uPerformance}}</p>
          </div>
          <div class="col-xs-6">
            <nvd3 options='vm.chartOptions' data='vm.chartData' ></nvd3>
          </div>
        </div>

        <div id="session-show-question" class="test-question-container" ng-hide="vm.testOver">
          <div id="result-display" ng-show="vm.result.display" class="alert alert-dismissible" ng-class="vm.result.correct ? 'alert-success' : 'alert-danger'">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <h1><strong>{{vm.result.text}}</strong></h1>
          </div>
          <!-- Question Text -->
          <p ng-click="showChoices = !showChoices" class="test-question-text"><span class="label {{vm.session.answers[vm.trackingData.qIdx]._question.catClass}}"><i class="fa {{vm.session.answers[vm.trackingData.qIdx]._question.catIcon}}" aria-hidden="true"></i></span>  {{vm.session.answers[vm.trackingData.qIdx]._question.text}}</p>

          <div ng-repeat="choice in vm.session.answers[vm.trackingData.qIdx]._question.choices" class="answer-choice-container session-answer-choice" ng-click="vm.selectAnswer(choice)" 
          ng-class="{
          'session-chosen-answer': vm.uChoice === choice,
          'correct-answer': vm.result.display && choice.text === vm.session.answers[vm.trackingData.qIdx]._question.correct.text,
          'wrong-answer': vm.result.display && choice.text !== vm.session.answers[vm.trackingData.qIdx]._question.correct.text  
          }">
            <p class="test-question-text">{{choice.id}}. {{choice.text}}</p>
          </div>

          <p>Chosen Answer: {{vm.uChoice}}</p>
          <div class="session-btn-container">
            <a ng-hide="vm.result.display" ng-click="vm.submitAnswer(vm.uChoice)" class="btn btn-block btn-success">Submit</a>
            <a ng-show="vm.result.display" ng-click="vm.nextQuestion()" class="btn btn-block btn-primary">Next Question</a>
          </div>
        </div>

        <div class="well" ng-show="vm.testOver">
          <h1>COMPLETION REPORT</h1>
          <h1>{{vm.trackingData.uPerformance.correct}} of {{vm.trackingData.uPerformance.total}} correct</h1>
          <a href="/sessions/new" class="btn btn-lg btn-success">Take another test</a>
          <a href="/" class="btn btn-lg btn-primary">Back to Home</a>

        </div>

        <br>
        <a ng-click="vm.toStart()" class="btn btn-warning">Back To Start</a>

        

        <div class="well">
          <p>{{vm.trackingData.uPerformance.correct}} of {{vm.trackingData.uPerformance.total}} correct</p>
          
          <ul ng-repeat="correct in vm.trackingData.uPerformance.byQuestion">
            <li>Correct?: {{correct}}</li>
          </ul>
          <ul ng-repeat="question in vm.session.answers">
            <li>Correct Answer: {{question._question.correct}}</li>
            <li>Your Answer: {{question.u_answer}}</li>
          </ul>
        </div>

      </div>
    </div>
  </div>
</div>

