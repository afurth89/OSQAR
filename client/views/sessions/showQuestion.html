<div class="row">
  <div class="col-xs-10 col-xs-offset-1">
    <div class="jumbotron pg-content-container">
      <!-- Back Button -->
      <a class="btn btn-danger back-btn" href="/sessions/new"><i class="fa fa-trash fa-2x" aria-hidden="true"></i></a>
      <!-- Title -->
      <h1 class="pg-content-title">{{vm.session._test.title}}</h1>
      <div class="well" id="session-question-page-container">
        
        <div class="row">
          <div class="col-xs-6">
            <p>#{{vm.trackingData.qNum}} of {{vm.testLength}}</p>
            <div class="progress progress-striped active">
              <div class="progress-bar" style="width: {{(vm.trackingData.qNum/vm.testLength)*100}}%"></div>
            </div>
            <div id="result-display" ng-show="vm.result.display" class="alert alert-dismissible" ng-class="vm.result.correct ? 'alert-success' : 'alert-danger'">
              <button type="button" class="close" data-dismiss="alert">&times;</button>
              <div id="result-display-content" class="row">
                <div class="col-xs-8 result-display-content-container">
                  <h2 id="result-display-text"><strong>{{vm.result.text}}</strong></h2>
                </div>
                <div class="col-xs-4 result-display-content-container">
                  <button type="button" id="result-display-nxt-btn" ng-show="vm.result.display" ng-click="vm.nextQuestion()" class="btn btn-md btn-primary">Next Question</button> 
                </div>
              </div>
            </div>
            <div id="final-result-display" ng-show="vm.testOver" class="alert alert-dismissible alert-warning">
              <button type="button" class="close" data-dismiss="alert">&times;</button>
              <div class="result-display-content-container">
                <button type="button" href="/sessions/new" class="btn btn-lg btn-success final-result-btn">Take another test</button>
              </div>
              <div class="result-display-content-container">
                <button type="button" href="/" class="btn btn-lg btn-primary final-result-btn" style="margin-left: 65px;">To Home</button>
              </div>
            </div>
          </div>
          <div class="col-xs-6">
            <nvd3 ng-hide="vm.trackingData.uPerformance.byQuestion.length === 0" options='vm.chartOptions' data='vm.chartData' ></nvd3>
          </div>
        </div>

        <div id="session-show-question" class="test-question-container" ng-hide="vm.testOver">
          <!-- Question Text -->
          <p ng-click="showChoices = !showChoices" class="test-question-text"><span class="label {{vm.session.answers[vm.trackingData.qIdx]._question.catClass}}"><i class="fa {{vm.session.answers[vm.trackingData.qIdx]._question.catIcon}}" aria-hidden="true"></i></span>  {{vm.session.answers[vm.trackingData.qIdx]._question.text}}</p>

          <!-- Question Choices -->
          <div ng-repeat="choice in vm.session.answers[vm.trackingData.qIdx]._question.choices" class="answer-choice-container session-answer-choice" ng-click="vm.selectAnswer(choice)" 
          ng-class="{
          'session-chosen-answer': vm.uChoice === choice,
          'correct-answer': vm.result.display && choice.text === vm.session.answers[vm.trackingData.qIdx]._question.correct.text,
          'wrong-answer': vm.result.display && choice.text !== vm.session.answers[vm.trackingData.qIdx]._question.correct.text  
          }">
            <p class="test-question-text"><strong>{{vm.letters[$index]}}:</strong> {{choice.text}}</p>
          </div>

          <!-- <p>Chosen Answer: {{vm.uChoice}}</p> -->
          <div class="session-btn-container">
            <a ng-hide="vm.result.display" ng-click="vm.submitAnswer(vm.uChoice)" class="btn btn-block btn-success">Submit</a>
          </div>
        </div>

        <div class="test-question-container" ng-show="vm.testOver">
          <h1>REPORT CARD</h1>
          <h1>{{vm.trackingData.uPerformance.correct}} of {{vm.trackingData.uPerformance.total}} correct</h1>
          <div class="answer-choice-container" ng-repeat="question in vm.session.answers" ng-class="vm.trackingData.uPerformance.byQuestion[$index] ? 'correct-answer' : 'wrong-answer'">
            <p><strong>Q: </strong>{{question._question.text}}</p>
            <ul>
              <li>
                <p>You Said: <strong>{{question.u_answer.text}}</strong></p>
              </li>
              <li>
                <p>Correct Answer: <strong>{{question._question.correct.text}}</strong></p>
              </li>
            </ul>
          </div>
        </div>

      </div>
      <a class="btn btn-danger" href="/sessions/new">End Session</a>
    </div>
  </div>
</div>

